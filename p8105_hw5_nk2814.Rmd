---
title: "p8105_hw5_nk2814"
author: "Naama Kipperman"
date: "11/5/2019"
output: github_document
---

```{r setup, include=FALSE}

library(tidyverse)
library(rvest)
library(readr)
knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(theme_minimal() + theme(legend.position = "bottom"))
```

#### Problem 1 



```{r}

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species)) 

replace_missing = function(x){
  if (is.numeric(x))
  {mutate(x = ifelse(is.na(x), mean(x, na.rm=TRUE), x))}
  else if (is.character(x))
  {mutate(x = ifelse(is.na(x), "virginica", x))}
}


```

Problem 1
```{r}

# We need to write a conditionally executed function

replace_missing3 = function(x){
  if (is.numeric(x))
  {x = replace_na(x, mean(x, na.rm=TRUE))}
  else if (is.character(x))
  {x = replace_na(x, "virginica")}
}



fixed_iris = map(iris_with_missing, replace_missing3) %>% 
  as_tibble()

```

#### Problem 2 

Data for each participant is included in a separate file, and file names include the subject ID and arm.

Create a tidy dataframe containing data from all participants, including the subject ID, arm, and observations over time:

Start with a dataframe containing all file names; the list.files function will help
Iterate over file names and read in data for each subject using purrr::map and saving the result as a new variable in the dataframe
Tidy the result; manipulate file names to include control arm and subject ID, make sure weekly observations are “tidy”, and do any other tidying that’s necessary
Make a spaghetti plot showing observations on each subject over time, and comment on differences between groups

```{r}

p2_data = list.files(path="./hw5_data/data", full.names=TRUE) %>% 
map_df(read.csv)




# problem - i'm not understanding how to write a function. 
  
```



