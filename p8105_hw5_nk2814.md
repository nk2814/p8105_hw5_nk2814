p8105\_hw5\_nk2814
================
Naama Kipperman
11/5/2019

#### Problem 1

``` r
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species)) 


# Write function that replaces missing values accordingly 

replace_missing_vals = function(x){
  if (is.numeric(x))
  {x = replace_na(x, mean(x, na.rm=TRUE))}
  else if (is.character(x))
  {x = replace_na(x, "virginica")}
}



fixed_iris = map(iris_with_missing, replace_missing_vals) %>% 
  as_tibble()
```

#### Problem 2

``` r
p2_data = list.files(path="./hw5_data/data", full.names=TRUE) %>% 
map_df(read.csv) %>% 
  mutate(
    subj_id = c(1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10),
    study_arm = c("control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "experimental", "experimental", "experimental", "experimental", "experimental", "experimental", "experimental", "experimental", "experimental", "experimental")
  ) %>% 
  select(subj_id, study_arm, everything()) %>% 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "values"
  ) %>% 
  mutate(
    week = as.factor(week),
    week = recode(week, "week_1"=1, "week_2"=2, "week_3"=3, "week_4"=4, "week_5"=5, "week_6"=6, "week_7"=7, "week_8"=8)) %>% 
  ggplot(aes(x=week, y=values, color=study_arm)) + geom_line(aes(group=study_arm))
```

Problem 3
